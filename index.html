<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âœ¨è®°å½•å’Œæ²«æ²«çš„å°ç½‘ç«™âœ¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'å¾®è½¯é›…é»‘', sans-serif;
        }

        body {
            min-height: 100vh;
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            transition: background-image 1s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: #000;
            overflow: hidden;
        }

        /* è§†é¢‘èƒŒæ™¯å®¹å™¨ */
        #video-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            overflow: hidden;
            opacity: 0;
            transition: opacity 1s ease;
        }

        #background-video {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            min-width: 100%;
            min-height: 100%;
            object-fit: cover;
        }

        /* é¡¶éƒ¨å¯¼èˆªæ  */
        .nav-bar {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 15px;
        }

        .nav-btn {
            color: white;
            font-size: 24px;
            cursor: pointer;
            background-color: rgba(0,0,0,0.3);
            padding: 8px 12px;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            background-color: rgba(0,0,0,0.6);
            transform: scale(1.1);
        }

        /* ä¸»å†…å®¹åŒº */
        .main-content {
            text-align: center;
            color: white;
            padding: 50px;
            z-index: 100;
            animation: fadeIn 1.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .title {
            font-size: 48px;
            color: #ff6b6b;
            margin-bottom: 20px;
            text-shadow: 2px 2px 10px rgba(0,0,0,0.3);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .countdown {
            font-size: 36px;
            color: #4ecdc4;
            margin: 20px 0;
            text-shadow: 1px 1px 5px rgba(0,0,0,0.5);
        }

        .subtitle {
            font-size: 24px;
            color: #f7fff7;
            margin-bottom: 50px;
            line-height: 1.6;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        /* éŸ³ä¹æ’­æ”¾å™¨æ ·å¼ */
        #music-player {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            background-color: rgba(0,0,0,0.5);
            padding: 10px 20px;
            border-radius: 30px;
            color: white;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        #music-toggle {
            cursor: pointer;
            font-size: 20px;
        }

        #music-progress {
            flex-grow: 1;
            height: 4px;
            background-color: rgba(255,255,255,0.2);
            border-radius: 2px;
            cursor: pointer;
            position: relative;
            max-width: 200px;
        }

        #progress-bar {
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            background-color: #ff6b6b;
            border-radius: 2px;
            width: 0%;
        }

        #time-display {
            font-size: 14px;
            min-width: 60px;
            text-align: center;
        }

        /* åŠ è½½æç¤º */
        #loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            z-index: 2000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 24px;
            transition: opacity 0.5s ease;
        }

        .loader {
            width: 50px;
            height: 50px;
            border: 5px solid #ff6b6b;
            border-bottom-color: transparent;
            border-radius: 50%;
            animation: rotation 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* è§†é¢‘/å›¾ç‰‡åˆ‡æ¢æŒ‰é’® */
        #bg-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            background-color: rgba(0,0,0,0.5);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        #bg-toggle:hover {
            background-color: rgba(0,0,0,0.8);
        }

        /* è§†é¢‘æ§åˆ¶æŒ‰é’® */
        #video-control {
            position: fixed;
            bottom: 20px;
            right: 160px;
            z-index: 1000;
            background-color: rgba(0,0,0,0.5);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        #video-control:hover {
            background-color: rgba(0,0,0,0.8);
        }

        /* æ¨¡æ€æ¡†æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            z-index: 3000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }
        
        .modal-content {
            background-color: #fefefe;
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            animation: modalIn 0.3s ease;
        }
        
        @keyframes modalIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .close-modal {
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 28px;
            cursor: pointer;
            color: #666;
        }
        
        .close-modal:hover {
            color: #333;
        }
        
        .diary-entry {
            margin-bottom: 20px;
            padding: 15px;
            border-left: 3px solid #ff6b6b;
            background-color: #f9f9f9;
            border-radius: 5px;
            position: relative;
        }
        
        .diary-date {
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 5px;
        }
        
        .diary-content {
            line-height: 1.6;
        }
        
        .diary-controls {
            margin-top: 20px;
            display: flex;
            gap: 10px;
        }
        
        .diary-controls button {
            flex-grow: 1;
            padding: 8px 15px;
            background-color: #ff6b6b;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        
        .diary-controls button:hover {
            background-color: #e65252;
        }
        
        .new-diary {
            margin-top: 20px;
            padding: 15px;
            background-color: #f1f1f1;
            border-radius: 5px;
        }
        
        .new-diary textarea {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-sizing: border-box;
            min-height: 100px;
            font-family: 'å¾®è½¯é›…é»‘', sans-serif;
        }
        
        .delete-diary {
            position: absolute;
            top: 10px;
            right: 10px;
            color: #ff6b6b;
            cursor: pointer;
            font-size: 18px;
            opacity: 0.7;
        }
        
        .delete-diary:hover {
            opacity: 1;
        }
        
        /* æ‰‹æœºé€‚é… */
        @media (max-width: 768px) {
            .title { font-size: 32px; }
            .countdown { font-size: 24px; }
            .subtitle { font-size: 18px; }
            .nav-btn { font-size: 20px; width: 36px; height: 36px; }
            #music-player { padding: 8px 15px; gap: 10px; }
            #time-display { display: none; }
            #bg-toggle { bottom: 80px; right: 20px; }
            #video-control { bottom: 120px; right: 20px; }
            
            .modal-content {
                width: 95%;
                padding: 15px;
            }
            
            .diary-controls {
                flex-direction: column;
            }
            
            .diary-controls button {
                width: 100%;
            }
        }
        
        /* æ–°å¢å¼¹å¹•æ ·å¼ */
        #danmaku-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 500;
            overflow: hidden;
        }
        
        .danmaku {
            position: absolute;
            white-space: nowrap;
            color: white;
            font-size: 24px;
            font-weight: bold;
            opacity: 0.7;
            user-select: none;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
        }
        
        @keyframes danmakuMove {
            from { transform: translateX(100%); }
            to { transform: translateX(-100%); }
        }
        
        .danmaku-fast {
            animation: danmakuMove 8s linear infinite;
        }
        
        .danmaku-medium {
            animation: danmakuMove 12s linear infinite;
        }
        
        .danmaku-slow {
            animation: danmakuMove 16s linear infinite;
        }
        
        /* å“åº”å¼è°ƒæ•´å¼¹å¹•å¤§å° */
        @media (max-width: 768px) {
            .danmaku {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <!-- è§†é¢‘èƒŒæ™¯å®¹å™¨ -->
    <div id="video-container">
        <video id="background-video" autoplay muted loop playsinline>
            <source src="background.mp4" type="video/mp4">
        </video>
    </div>

    <!-- åŠ è½½æç¤º -->
    <div id="loading-overlay">
        <div class="loader"></div>
        <p>ç‚¹å‡»å±å¹•å¼€å¯å›å¿†</p>
    </div>

    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <div class="nav-bar">
        
        <i class="nav-btn" id="openDiary">ğŸ“”</i>
        <i class="nav-btn" id="danmaku-toggle">ğŸ’¬</i>
    </div>

    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <div class="main-content">
        <h1 class="title">âœ¨ LOVE æ²«æ²«~ ~ ~ âœ¨</h1>
        <div class="countdown" id="loveDays">åŠ è½½ä¸­...</div>
        <p class="subtitle">
            æ¯ä¸€åˆ†æ¯ä¸€ç§’<br>
            éƒ½æ˜¯æˆ‘ä»¬â¤ï¸
        </p>
    </div>

    <!-- éŸ³ä¹æ’­æ”¾å™¨ -->
    <div id="music-player">
        <i id="music-icon" class="fa fa-play">â–¶ï¸</i>
        <div id="music-progress">
            <div id="progress-bar"></div>
        </div>
        <div id="time-display">00:00</div>
    </div>

    <!-- è§†é¢‘/å›¾ç‰‡åˆ‡æ¢æŒ‰é’® -->
    <div id="bg-toggle">å…³é—­èƒŒæ™¯</div>
    
    <!-- è§†é¢‘æ§åˆ¶æŒ‰é’® -->
    <div id="video-control">ä¸‹ä¸€ä¸ª</div>

    <!-- æ—¥è®°å¼¹çª— -->
    <div id="diary-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>ğŸ“” æˆ‘ä»¬çš„çˆ±æƒ…æ—¥è®°</h2>
            <div id="diary-entries" class="diary-entries">
                <!-- æ—¥è®°æ¡ç›®å°†é€šè¿‡JSåŠ¨æ€æ·»åŠ  -->
            </div>
            <div class="diary-controls">
                <button id="add-diary">æ·»åŠ æ–°æ—¥è®°</button>
                <button id="save-diaries">ä¿å­˜æ—¥è®°</button>
            </div>
        </div>
    </div>

    <!-- å¼¹å¹•å®¹å™¨ -->
    <div id="danmaku-container"></div>

    <!-- èƒŒæ™¯éŸ³ä¹æ’­æ”¾å™¨ -->
    <audio id="backgroundMusic" loop>
        <source src="ç‰¹åˆ«çš„äºº - æ–¹å¤§åŒ.mp3" type="audio/mpeg">
    </audio>

    <script>
        // é…ç½®é¡¹
        const CONFIG = {
            loveStartDate: '2024-06-18', // æ‹çˆ±å¼€å§‹æ—¥æœŸï¼ˆYYYY-MM-DDï¼‰
            mediaList: [
                // åª’ä½“é¡¹æ ¼å¼: {type: 'image'/'video', src: 'è·¯å¾„', duration: æ˜¾ç¤ºæ—¶é•¿(ä»…å›¾ç‰‡éœ€è¦)}
                {type: 'image', src: '1.jpg', duration: 5000},
                {type: 'image', src: '2.jpg', duration: 5000},
                {type: 'image', src: '3.jpg', duration: 5000},
                {type: 'image', src: '4.jpg', duration: 5000},
                {type: 'image', src: '5.jpg', duration: 5000},
                {type: 'image', src: '6.jpg', duration: 5000},
                {type: 'image', src: '7.jpg', duration: 5000},
                {type: 'image', src: '8.jpg', duration: 5000},
                {type: 'image', src: '9.jpg', duration: 5000},
                {type: 'image', src: '10.jpg', duration: 5000},
                {type: 'image', src: '11.jpg', duration: 5000},
                {type: 'image', src: '12.jpg', duration: 5000},
                {type: 'image', src: '13.jpg', duration: 5000},
                {type: 'image', src: '14.jpg', duration: 5000},
                {type: 'image', src: '15.jpg', duration: 5000},
                {type: 'image', src: '16.jpg', duration: 5000},
                {type: 'image', src: '17.jpg', duration: 5000},
                {type: 'image', src: '18.jpg', duration: 5000},
                {type: 'image', src: '19.jpg', duration: 5000},
                {type: 'image', src: '20.jpg', duration: 5000},
                {type: 'image', src: '21.jpg', duration: 5000},
                {type: 'image', src: '22.jpg', duration: 5000},
                {type: 'image', src: '23.jpg', duration: 5000},
                {type: 'image', src: '24.jpg', duration: 5000},
                {type: 'image', src: '25.jpg', duration: 5000},
                {type: 'image', src: '26.jpg', duration: 5000},
                {type: 'image', src: '27.jpg', duration: 5000},
                {type: 'image', src: '28.jpg', duration: 5000},
                {type: 'image', src: '29.jpg', duration: 5000},
                {type: 'image', src: '30.jpg', duration: 5000},
                {type: 'image', src: '31.jpg', duration: 5000},
                {type: 'image', src: '32.jpg', duration: 5000},
                {type: 'image', src: '33.jpg', duration: 5000},
                {type: 'image', src: '34.jpg', duration: 5000},
                {type: 'image', src: '35.jpg', duration: 5000},
                {type: 'image', src: '36.jpg', duration: 5000},
                {type: 'image', src: '37.jpg', duration: 5000},
                {type: 'image', src: '38.jpg', duration: 5000},
                {type: 'image', src: '39.jpg', duration: 5000},
                {type: 'image', src: '40.jpg', duration: 5000},
                {type: 'image', src: '41.jpg', duration: 5000},
                {type: 'image', src: '42.jpg', duration: 5000},
                {type: 'image', src: '43.jpg', duration: 5000},
                {type: 'image', src: '44.jpg', duration: 5000},
                {type: 'image', src: '45.jpg', duration: 5000},
                {type: 'image', src: '46.jpg', duration: 5000},
                {type: 'image', src: '47.jpg', duration: 5000},
                {type: 'image', src: '48.jpg', duration: 5000},
                {type: 'image', src: '49.jpg', duration: 5000},
                {type: 'image', src: '50.jpg', duration: 5000},
                {type: 'image', src: '51.jpg', duration: 5000},
                {type: 'image', src: '52.jpg', duration: 5000},
                {type: 'image', src: '53.jpg', duration: 5000},
                {type: 'image', src: '54.jpg', duration: 5000},
                {type: 'image', src: '55.jpg', duration: 5000},
                {type: 'image', src: '56.jpg', duration: 5000},
                {type: 'image', src: '57.jpg', duration: 5000},
                {type: 'image', src: '58.jpg', duration: 5000},
                {type: 'image', src: '59.jpg', duration: 5000},
                {type: 'image', src: '60.jpg', duration: 5000},
                {type: 'image', src: '61.jpg', duration: 5000},
                {type: 'image', src: '62.jpg', duration: 5000},
                {type: 'image', src: '63.jpg', duration: 5000},
                {type: 'image', src: '64.jpg', duration: 5000},
                {type: 'image', src: '65.jpg', duration: 5000},
                {type: 'image', src: '66.jpg', duration: 5000},
                {type: 'image', src: '67.jpg', duration: 5000},
                {type: 'image', src: '68.jpg', duration: 5000},
                {type: 'image', src: '69.jpg', duration: 5000},
                {type: 'image', src: '70.jpg', duration: 5000},
                {type: 'image', src: '71.jpg', duration: 5000},
                {type: 'image', src: '72.jpg', duration: 5000},
                {type: 'image', src: '73.jpg', duration: 5000},
                {type: 'image', src: '74.jpg', duration: 5000},
                {type: 'image', src: '75.jpg', duration: 5000},
                {type: 'image', src: '76.jpg', duration: 5000},
                {type: 'image', src: '77.jpg', duration: 5000},
                {type: 'image', src: '78.jpg', duration: 5000},
                

                {type: 'video', src: '1.mp4', duration: 12000},
                {type: 'video', src: '2.mp4', duration: 12000},
                {type: 'video', src: '3.mp4', duration: 12000},
                {type: 'video', src: '4.mp4', duration: 12000},
                {type: 'video', src: '5.mp4', duration: 12000},
                {type: 'video', src: '6.mp4', duration: 12000},
                {type: 'video', src: '7.mp4', duration: 12000},
                {type: 'video', src: '8.mp4', duration: 12000},
                {type: 'video', src: '9.mp4', duration: 12000},
                {type: 'video', src: '10.mp4', duration: 12000},
                {type: 'video', src: '11.mp4', duration: 12000},
                
                // ç»§ç»­æ·»åŠ æ›´å¤šåª’ä½“...
            ],
            musicUrl: 'ç‰¹åˆ«çš„äºº - æ–¹å¤§åŒ.mp3', // éŸ³ä¹æ–‡ä»¶åœ°å€
            initialVolume: 0.7, // åˆå§‹éŸ³é‡ (0-1)
            defaultToMediaPlayer: true, // é»˜è®¤ä½¿ç”¨åª’ä½“æ’­æ”¾å™¨
            shuffleMedia: true, // éšæœºæ’­æ”¾åª’ä½“
            
            // å¼¹å¹•ç›¸å…³é…ç½® - å¤§å¹…å‡å°‘å¼¹å¹•æ–‡æ¡ˆæ•°é‡
            danmakuTexts: [
                "é™ˆè€å¸ˆï¼Œä½ çš„æœ‹å‹åœˆçœŸå¥½çœ‹~ ~ ~",
                "ä½ æƒ³è¦ä¸€ä¸ªæœºä¼šè¿˜æ˜¯ç­”æ¡ˆ~",
                "å¦‚æœæˆ‘è¯´éƒ½è¦ï¼Œä¼šä¸ä¼šæ¯”è¾ƒè´ªå¿ƒå‘€",
                "å½“ç„¶æ˜¯è¦çœ‹å“¥å“¥æ€ä¹ˆå‹¾å¼•æˆ‘å¯¹æˆ‘è€ä»€ä¹ˆæ‰‹æ®µå‘€",
                "å˜¿å˜¿å˜¿~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ " ,
                "å®å®ä¸€å‘¨å¹´å¿«ä¹å‘€~ ~ ~ ~ ~  ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ",
                "ç°åœ¨æ˜¯6.11å·æˆ‘ç»ˆäºå†™åˆ°å¼¹å¹•äº†ï¼ŒçœŸæ˜¯éš¾æ­»äº†",
                "ä¹Ÿä¸çŸ¥é“ä½ çœ‹åˆ°ä¼šæ˜¯ä»€ä¹ˆå¿ƒæƒ…å˜ï¼Œå˜¿å˜¿å˜¿",
                "å¼€å¿ƒå—ï¼ï¼ï¼        æƒŠå–œå—ï¼ï¼ï¼           å´‡æ‹œæˆ‘å—ï¼ï¼ï¼         æˆ‘å‰å®³å—ï¼ï¼ï¼        ä½è°ƒä½è°ƒå‘€å®å®ï¼ï¼ï¼",
                "æˆ‘ç®€ç›´å¤ªå‰å®³äº†ï¼Œè¿™ä¸ªæ˜¯ä¸æ˜¯éå¸¸çš„å°ä¼—ï¼ï¼ï¼",
                "åˆ«äººéƒ½æ˜¯ä»€ä¹ˆçºªå¿µå†Œï¼Œä»€ä¹ˆä¹¦å•¥çš„",
                "é‡åˆ°æˆ‘è¿™ä¸ªç½‘ç«™ï¼Œé‚£äº›æ˜¯ä¸æ˜¯éƒ½å¼±çˆ†äº†ï¼ï¼ï¼ï¼ï¼",
                "å˜¿å˜¿å˜¿å…¶å®ä¹‹å‰æœ‰æƒ³è¿‡åšé‚£ä¸ªä¹¦ï¼Œç»“æœè¢«synæŠ¢å…ˆäº†",
                "ç„¶åæˆ‘å°±æƒ³æ€ä¹ˆæ ·èƒ½è·Ÿä»–é‚£ä¸ªä¸ä¸€æ ·",
                "ç„¶åæˆ‘å°±æƒ³åˆ°ï¼Œç½‘ç«™ä¹Ÿå¯ä»¥æ˜¯å·®ä¸å¤šçš„æ•ˆæœ",
                "è€Œä¸”æ¯”ä»–ä»¬é‚£äº›æ›´å‰å®³ï¼Œè¿˜æ˜¯åŠ¨æ€çš„ï¼Œæ›´é«˜çº§",
                "è€Œä¸”ä¸ä¼šè·Ÿä»–ä»¬é‚£äº›æ’ï¼Œè¿™å°±æ˜¯å…¨ä¸–ç•Œç‹¬ä¸€ä»½",
                "åˆ«äººæƒ³è¦éƒ½æ²¡æœ‰å˜¿å˜¿å˜¿","ä½ å°±å·ç€ä¹å§",
                "åæ­£å…¨ç½‘æˆ‘éƒ½æ²¡æœ‰çœ‹åˆ°",
                "ä½†æ˜¯ä½ ç°åœ¨çœ‹åˆ°çš„è¿™ä¸ªæ˜¯æˆ‘å°è¯•äº†åšè·Ÿçºªå¿µä¹¦å·®ä¸å¤šçš„ï¼Œä½†æ˜¯åšå‡ºæ¥ä¼šå¾ˆä¸‘",
                "æ‰€ä»¥æˆ‘å°±åšäº†è¿™ä¸ª",
                "å˜»å˜»å˜»å®å®ä¸è¦å«Œå¼ƒå“¦ï¼Œæˆ‘ä¼šæ…¢æ…¢å®Œå–„çš„",
                "ä¸ä¼šæ”¾ä»»ä¸ç®¡å“’",
                "OKå‘€ä¸çŸ¥é“è¯´å•¥å•¦ï¼Œé‚£å°±å†è¯´ä¸€ä¸‹ä¸€å‘¨å¹´å¿«ä¹å‘€~",
                "å…¶å®å’±ä»¬çš„å°æ—¥å­è¿˜æŒºå¹³ç¨³çš„ï¼Œè™½ç„¶ä¸€å‡ºäº‹å°±æ˜¯å¤§äº‹å˜»å˜»å˜»",
                "æ‰€ä»¥å°±å¸Œæœ›æˆ‘ä»¬ä»¥åçš„çˆ±æƒ…å¯ä»¥ä¸€å¸†é£é¡º",
                "è€Œä¸”æˆ‘ä»¬ä¹‹å‰å­¦æ ¡çš„äº‹æƒ…éƒ½å¹³ç¨³è¿‡ä¸‹æ¥äº†ï¼Œé‚£ä»¥åè‚¯å®šä¸€å¸†é£é¡º",
                "å°±å¸Œæœ›æˆ‘ä»¬ä»¥åå¯ä»¥å°‘ä¸€ç‚¹åµæ¶ï¼Œä¸è¦å†ç›¸èä¹‹å‰",
                "å¤§æ™šä¸Šç»™æˆ‘å‘å®Œæ¶ˆæ¯å°±ç›´æ¥æ‹‰é»‘åˆ é™¤ä¸€æ¡é¾™",
                "ç„¶åæˆ‘ä»¥åä¹Ÿä¼šä¹–ä¹–çš„ï¼Œä¸æƒ¹ä½ ç”Ÿæ°”å•¦~ ~ ~",
                "å½“ç„¶å•¦ï¼Œå’±ä»¬å‘¢ï¼Œå‰æ®µæ—¶é—´æ˜¯å› ä¸ºå¾ˆé•¿æ—¶é—´ä¸è§é¢ï¼ŒåŠ ä¸Šå­¦æ ¡çš„äº‹æƒ…å¿ƒçƒ¦",
                "æˆ‘è§‰å¾—å’±ä»¬åé¢è‚¯å®šæ²¡æœ‰å°±ä¸ä¼šå•¦å¯¹ä¸å¯¹å‘€å®å®",
                "å’±ä»¬ä¹Ÿé©¬ä¸Šæ”¾å‡å•¦ï¼Œç­‰ä½ çœ‹åˆ°è¿™ä¸ªçš„æ—¶å€™æˆ‘ä»¬è‚¯å®šå°±æ”¾å‡å•¦",
                "ä¹Ÿä¸çŸ¥é“å‡æœŸæˆ‘ä»¬èƒ½ä¸èƒ½å‡ºæ¥ç©~ ~ ~ ~ ~ ~ ~ ~ ~ ~",
                "æœ‰ç‚¹æƒ³çº¦ä¼š~ ~ ~ ~ ~ ~ ",
                "è¦æ˜¯çœŸçš„èƒ½çº¦ä¼šï¼Œæˆ‘è®°å¾—å¯ä»¥å»å›é¡¾ä¸‹ç¬¬ä¸€æ¬¡è§é¢çš„åœ°ï¼Œæ„Ÿè§‰å¤ªä¸é”™äº†å‘€",
                "å½“æ—¶è€å®³ç¾äº†ï¼Œæ€ªæ”¾ä¸å¼€çš„ï¼Œä½ å½“æ—¶è¿˜å‹åŠ›æˆ‘",
                "çªç€æˆ‘è¿˜ï¼Œæ€ªå®³æ€•çš„å˜»å˜»å˜»",
                "è¿˜æœ‰ç‚¹å®³ç¾",
                "ç°åœ¨å†å»å°±è‚¯å®šä¸ä¼šå•¦ï¼Œç›´æ¥å¼ºå»ä½ ~ ~ ~ ~  ~",
                "ä¸çŸ¥ä¸è§‰å°±ä¸€å‘¨å¹´äº†",
                "æ—¶é—´è¿‡çš„å¥½å¿«å“¦",
                "çœŸçš„æ˜¯ä¸çŸ¥ä¸è§‰çš„",
                "æ„Ÿè§‰æ˜¨å¤©è¿˜åœ¨å«é™ˆè€å¸ˆ~ ~ ~ ~ ~",
                "å˜¿å˜¿å˜¿ï¼Œå¸Œæœ›æˆ‘ä»¬ä»¥åå¯ä»¥å°‘ä¸€ç‚¹äº‰åµå˜¿å˜¿",
                "å¸Œæœ›æˆ‘ä»¬çš„çˆ±æƒ…ï¼Œå¯ä»¥å¤©é•¿åœ°ä¹…ï¼Œæ°¸ä¸åˆ†ç¦»",
                "è™½ç„¶å’Œæˆ‘ä»¬å®å®åœ¨ä¸€èµ·ï¼Œæˆ‘è§‰å¾—è¿˜æ˜¯å¿«ä¹å¤šä¸€ç‚¹",
                "ä½†æ€•ä½ å› ä¸ºåµæ¶è€Œæœ‰ä»€ä¹ˆæƒ³æ³•ï¼Œæ‰€ä»¥æˆ‘è¿˜æ˜¯ä¹–ä¸€ç‚¹å§~ ~ ~",
                "çˆ±ä½ å“Ÿå®å®~ ~ ~å˜¿å˜¿å˜¿å˜¿å˜¿å˜¿å˜¿"
                
            ],
            danmakuInterval: 3000, // å¼¹å¹•å‡ºç°é—´éš”ï¼ˆæ¯«ç§’ï¼‰- è°ƒæ•´ä¸º5ç§’ï¼Œé¿å…è¿‡å¿«
            maxActiveDanmakus: 1, // æœ€å¤§åŒæ—¶æ˜¾ç¤ºçš„å¼¹å¹•æ•°é‡-æ”¹ä¸º1æ¡ï¼Œç¡®ä¿é¡ºåºæ¸…æ™°
            playDanmakuInOrder: true, // æ–°å¢é…ç½®ï¼šæ˜¯å¦æŒ‰é¡ºåºæ’­æ”¾å¼¹å¹•
        };

        // å…¨å±€å˜é‡
        let currentMediaIndex = 0;
        let mediaTimer;
        let danmakuTimer;
        let activeDanmakus = 0;
        let isDanmakuEnabled = true;
        let currentDanmakuIndex = 0; // æ–°å¢ï¼šå½“å‰å¼¹å¹•ç´¢å¼•

        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            // è®¡ç®—æ‹çˆ±å¤©æ•°
            updateLoveDays();
            
            // è®¾ç½®éŸ³ä¹
            const audio = document.getElementById('backgroundMusic');
            audio.volume = CONFIG.initialVolume;
            
            // ç›‘å¬é¡µé¢ç‚¹å‡»ä»¥è§£é™¤ç§»åŠ¨ç«¯éŸ³é¢‘é™åˆ¶
            document.addEventListener('click', function startAudio() {
                if (audio.paused) {
                    audio.play().catch(e => console.log('éŸ³é¢‘è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢:', e));
                }
                document.removeEventListener('click', startAudio);
            });
            
            // åˆå§‹åŒ–éŸ³ä¹æ’­æ”¾å™¨
            initMusicPlayer();
            
            // åˆå§‹åŒ–åª’ä½“æ’­æ”¾å™¨
            if (CONFIG.defaultToMediaPlayer && CONFIG.mediaList.length > 0) {
                setupMediaPlayer();
            }
            
            // åˆå§‹åŒ–æ—¥è®°ç³»ç»Ÿ
            loadDiaries();
            
            // åˆå§‹åŒ–å¼¹å¹•ç³»ç»Ÿ
            startDanmakuSystem();
            
            // ç›‘å¬åŠ è½½å®Œæˆ
            window.addEventListener('load', function() {
                setTimeout(function() {
                    document.getElementById('loading-overlay').style.opacity = '0';
                    setTimeout(function() {
                        document.getElementById('loading-overlay').style.display = 'none';
                    }, 500);
                }, 1000);
            });
        });

        function updateLoveDays() {
            const start = new Date(CONFIG.loveStartDate);
            const now = new Date();
            const diff = now - start;
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            document.getElementById('loveDays').textContent = `æˆ‘ä»¬å·²ç»åœ¨ä¸€èµ·ï¼š${days}å¤© ${hours}å°æ—¶ ${minutes}åˆ†é’Ÿ`;
        }

        
        // åˆå§‹åŒ–éŸ³ä¹æ’­æ”¾å™¨
        function initMusicPlayer() {
            const audio = document.getElementById('backgroundMusic');
            const musicIcon = document.getElementById('music-icon');
            const progressBar = document.getElementById('progress-bar');
            const timeDisplay = document.getElementById('time-display');
            const musicProgress = document.getElementById('music-progress');
            
            // éŸ³ä¹æ’­æ”¾/æš‚åœåˆ‡æ¢
            musicIcon.addEventListener('click', function() {
                if (audio.paused) {
                    audio.play().catch(e => console.log('éŸ³é¢‘æ’­æ”¾è¢«é˜»æ­¢:', e));
                    musicIcon.textContent = 'â¸ï¸';
                } else {
                    audio.pause();
                    musicIcon.textContent = 'â–¶ï¸';
                }
            });
            
            // æ›´æ–°è¿›åº¦æ¡
            audio.addEventListener('timeupdate', function() {
                const percent = (audio.currentTime / audio.duration) * 100;
                progressBar.style.width = percent + '%';
                
                // æ›´æ–°æ—¶é—´æ˜¾ç¤º
                const currentMinutes = Math.floor(audio.currentTime / 60);
                const currentSeconds = Math.floor(audio.currentTime % 60);
                const durationMinutes = Math.floor(audio.duration / 60);
                const durationSeconds = Math.floor(audio.duration % 60);
                
                timeDisplay.textContent = `${padZero(currentMinutes)}:${padZero(currentSeconds)} / ${padZero(durationMinutes)}:${padZero(durationSeconds)}`;
            });
            
            // ç‚¹å‡»è¿›åº¦æ¡è·³è½¬åˆ°æŒ‡å®šä½ç½®
            musicProgress.addEventListener('click', function(e) {
                const rect = musicProgress.getBoundingClientRect();
                const pos = (e.clientX - rect.left) / rect.width;
                audio.currentTime = pos * audio.duration;
            });
            
            // æ ¼å¼åŒ–æ—¶é—´ï¼ˆæ·»åŠ å‰å¯¼é›¶ï¼‰
            function padZero(num) {
                return num < 10 ? '0' + num : num;
            }
        }

        // è®¾ç½®åª’ä½“æ’­æ”¾å™¨
        function setupMediaPlayer() {
            const videoContainer = document.getElementById('video-container');
            const backgroundVideo = document.getElementById('background-video');
            const bgToggle = document.getElementById('bg-toggle');
            const videoControl = document.getElementById('video-control');
            
            // éšæœºæ’åºåª’ä½“åˆ—è¡¨
            if (CONFIG.shuffleMedia) {
                CONFIG.mediaList.sort(() => Math.random() - 0.5);
            }
            
            // æ˜¾ç¤ºç¬¬ä¸€ä¸ªåª’ä½“
            displayMedia(0);
            
            // èƒŒæ™¯åˆ‡æ¢æŒ‰é’®
            bgToggle.addEventListener('click', function() {
                if (videoContainer.style.opacity === '0' || videoContainer.style.opacity === '') {
                    videoContainer.style.opacity = '1';
                    bgToggle.textContent = 'å…³é—­èƒŒæ™¯';
                } else {
                    videoContainer.style.opacity = '0';
                    bgToggle.textContent = 'æ‰“å¼€èƒŒæ™¯';
                }
            });
            
            // ä¸‹ä¸€ä¸ªåª’ä½“æŒ‰é’®
            videoControl.addEventListener('click', function() {
                currentMediaIndex = (currentMediaIndex + 1) % CONFIG.mediaList.length;
                displayMedia(currentMediaIndex);
            });
        }

        // æ˜¾ç¤ºæŒ‡å®šç´¢å¼•çš„åª’ä½“
        function displayMedia(index) {
            const media = CONFIG.mediaList[index];
            const videoContainer = document.getElementById('video-container');
            const backgroundVideo = document.getElementById('background-video');
            
            // æ¸…é™¤ä¹‹å‰çš„è®¡æ—¶å™¨
            if (mediaTimer) {
                clearTimeout(mediaTimer);
            }
            
            if (media.type === 'video') {
                // æ˜¾ç¤ºè§†é¢‘
                backgroundVideo.src = media.src;
                backgroundVideo.load();
                backgroundVideo.play();
                
                // è§†é¢‘æ’­æ”¾ç»“æŸåè‡ªåŠ¨åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ª
                backgroundVideo.onended = function() {
                    currentMediaIndex = (currentMediaIndex + 1) % CONFIG.mediaList.length;
                    displayMedia(currentMediaIndex);
                };
                
                videoContainer.style.opacity = '1';
            } else if (media.type === 'image') {
                // æ˜¾ç¤ºå›¾ç‰‡
                const img = new Image();
                img.onload = function() {
                    // åˆ›å»ºä¸€ä¸ªä¸´æ—¶å…ƒç´ æ¥æ˜¾ç¤ºå›¾ç‰‡
                    const imgElement = document.createElement('div');
                    imgElement.style.backgroundImage = `url('${media.src}')`;
                    imgElement.style.backgroundSize = 'cover';
                    imgElement.style.backgroundPosition = 'center';
                    imgElement.style.position = 'absolute';
                    imgElement.style.top = '0';
                    imgElement.style.left = '0';
                    imgElement.style.width = '100%';
                    imgElement.style.height = '100%';
                    
                    // æ›¿æ¢è§†é¢‘å®¹å™¨å†…å®¹
                    while (videoContainer.firstChild) {
                        videoContainer.removeChild(videoContainer.firstChild);
                    }
                    videoContainer.appendChild(imgElement);
                    videoContainer.style.opacity = '1';
                    
                    // è®¾ç½®è®¡æ—¶å™¨åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªåª’ä½“
                    mediaTimer = setTimeout(function() {
                        currentMediaIndex = (currentMediaIndex + 1) % CONFIG.mediaList.length;
                        displayMedia(currentMediaIndex);
                    }, media.duration);
                };
                img.src = media.src;
            }
        }

        

        // åˆå§‹åŒ–æ—¥è®°ç³»ç»Ÿ
        function loadDiaries() {
            const diaryEntries = document.getElementById('diary-entries');
            const addDiaryBtn = document.getElementById('add-diary');
            const saveDiariesBtn = document.getElementById('save-diaries');
            const diaryModal = document.getElementById('diary-modal');
            const openDiaryBtn = document.getElementById('openDiary');
            const closeModal = document.querySelector('.close-modal');
            

            // åˆå§‹æ—¥è®°æ•°æ®ï¼ˆå¯ä»æœ¬åœ°å­˜å‚¨åŠ è½½ï¼‰
        let diaries = JSON.parse(localStorage.getItem('loveDiaries')) || [
                {
                    date: '2025-06-09',
                    content: 'ä»Šå¤©æ˜¯å‘¨ä¸€ï¼Œå‰ä¸¤å¤©çªå‘å¥‡æƒ³ï¼ˆå¤§æ¦‚æ˜¯3å·ï¼‰ï¼Œæƒ³ç»™æˆ‘ä»¬åšä¸€ä¸ªç½‘ç«™ï¼ˆå…¶å®ä¹Ÿä¸æ˜¯çªå‘å¥‡æƒ³ï¼Œæˆ‘ä¹‹å‰å°±æœ‰æƒ³åˆ°è¿‡ï¼Œç”¨ç‹¬ç‰¹çš„æ–¹å¼è®°å½•ä¸€ä¸‹æˆ‘ä»¬ï¼‰é‚£ä¸ºä»€ä¹ˆæ˜¯ä»Šå¤©æ‰å¼€å§‹æœ‰æ—¥è®°å‘¢ï¼Œé‚£æ˜¯å› ä¸ºä»Šå¤©æ‰æŠŠç½‘ç«™çš„æ¡†æ¶æ­å¥½å˜»å˜»å˜»'
                },
                {
                    date: '2025-06-10',
                    content: 'ä»Šå¤©æ˜¯å‘¨äºŒï¼Œæˆ‘ä»¬ä»Šå¤©è€ƒè¯•äº†ï¼Œå˜»å˜»å˜»å˜»å˜»æœ‰ç‚¹æ²¡äº²å¤Ÿï¼Œè¿˜æƒ³äº²äº²~ï¼Œå’±ä»¬ä»Šå¤©è¿˜è¯´é©¬ä¸Šä¸€å‘¨å¹´ï¼Œæˆ‘ä»¬è¯¥å’‹è¿‡å‘€ï¼Œæˆ‘ä¹Ÿåœ¨æ€è€ƒï¼Œå˜¤å˜¤å˜¤ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“å’‹è¿‡ï¼Œéƒ½ä¸çŸ¥é“èƒ½ä¸èƒ½è§é¢å˜'
                },
                {
                    date: '2025-06-11',
                    content: 'ä»Šå¤©æ˜¯å‘¨ä¸‰ï¼Œæˆ‘ä»¬ä»Šå¤©åˆè€ƒè¯•äº†ï¼Œä»Šå¤©è¿˜æ˜¯æƒ³äº²äº²~ ~ ~ï¼Œä»Šå¤©è€ƒè¯•ä½ åƒå°å‚»è›‹æ€ªå¯çˆ±çš„å˜ï¼Œä½†æ˜¯æœ€åä½ è¿˜ç™½çœ¼æˆ‘è®©æˆ‘å¥½å¿ƒå¯’å“¦ï¼Œç°åœ¨æ˜¯æ™šè‡ªä¹ ï¼Œæˆ‘åœ¨æ€è€ƒä»€ä¹ˆæ—¶å€™æŠŠç½‘ç«™å‘Šè¯‰ä½  ç»™ä½ çœ‹ï¼Œæ˜¯å‘¨äº”è¿˜æ˜¯18å·å‘¢ï¼Œå¥½çº ç»“'
                },

            ];

            // ä»æœ¬åœ°å­˜å‚¨åŠ è½½æ—¥è®°
            // let diaries = JSON.parse(localStorage.getItem('loveDiaries')) || [];
            
            // æ¸²æŸ“æ—¥è®°åˆ—è¡¨
            renderDiaries(diaries);
            
            // æ‰“å¼€æ—¥è®°æ¨¡æ€æ¡†
            openDiaryBtn.addEventListener('click', function() {
                diaryModal.style.display = 'flex';
            });
            
            // å…³é—­æ—¥è®°æ¨¡æ€æ¡†
            closeModal.addEventListener('click', function() {
                diaryModal.style.display = 'none';
            });
            
            // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
            diaryModal.addEventListener('click', function(e) {
                if (e.target === diaryModal) {
                    diaryModal.style.display = 'none';
                }
            });
            
            // æ·»åŠ æ–°æ—¥è®°
            addDiaryBtn.addEventListener('click', function() {
                const newDiaryDiv = document.createElement('div');
                newDiaryDiv.className = 'new-diary';
                newDiaryDiv.innerHTML = `
                    <div class="diary-date">ä»Šå¤©</div>
                    <textarea placeholder="å†™ä¸‹ä»Šå¤©çš„æ„Ÿå—..."></textarea>
                    <button class="save-diary">ä¿å­˜</button>
                    <button class="cancel-diary">å–æ¶ˆ</button>
                `;
                
                diaryEntries.appendChild(newDiaryDiv);
                
                // ä¿å­˜æ–°æ—¥è®°
                newDiaryDiv.querySelector('.save-diary').addEventListener('click', function() {
                    const content = newDiaryDiv.querySelector('textarea').value;
                    if (content.trim()) {
                        const newDiary = {
                            date: new Date().toLocaleDateString(),
                            content: content
                        };
                        
                        diaries.unshift(newDiary); // æ·»åŠ åˆ°æ•°ç»„å¼€å¤´
                        renderDiaries(diaries);
                        saveDiaries(diaries);
                    }
                    diaryEntries.removeChild(newDiaryDiv);
                });
                
                // å–æ¶ˆæ·»åŠ 
                newDiaryDiv.querySelector('.cancel-diary').addEventListener('click', function() {
                    diaryEntries.removeChild(newDiaryDiv);
                });
            });
            
            // ä¿å­˜æ‰€æœ‰æ—¥è®°
            saveDiariesBtn.addEventListener('click', function() {
                saveDiaries(diaries);
            });
            
            // æ¸²æŸ“æ—¥è®°åˆ—è¡¨
            function renderDiaries(diaries) {
                diaryEntries.innerHTML = '';
                
                diaries.forEach(function(diary, index) {
                    const entryDiv = document.createElement('div');
                    entryDiv.className = 'diary-entry';
                    entryDiv.innerHTML = `
                        <div class="diary-date">${diary.date}</div>
                        <div class="diary-content">${diary.content}</div>
                        <span class="delete-diary" data-index="${index}">âŒ</span>
                    `;
                    
                    diaryEntries.appendChild(entryDiv);
                    
                    // åˆ é™¤æ—¥è®°
                    entryDiv.querySelector('.delete-diary').addEventListener('click', function() {
                        if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ç¯‡æ—¥è®°å—ï¼Ÿ')) {
                            diaries.splice(index, 1);
                            renderDiaries(diaries);
                            saveDiaries(diaries);
                        }
                    });
                });
            }
            
            // ä¿å­˜æ—¥è®°åˆ°æœ¬åœ°å­˜å‚¨
            function saveDiaries(diaries) {
                localStorage.setItem('loveDiaries', JSON.stringify(diaries));
                alert('æ—¥è®°å·²ä¿å­˜');
            }
        }

        // å¼¹å¹•ç³»ç»Ÿ
        function startDanmakuSystem() {
            const danmakuContainer = document.getElementById('danmaku-container');
            const danmakuToggle = document.getElementById('danmaku-toggle');
            
            // åˆ‡æ¢å¼¹å¹•å¼€å…³
            danmakuToggle.addEventListener('click', function() {
                isDanmakuEnabled = !isDanmakuEnabled;
                danmakuToggle.textContent = isDanmakuEnabled ? 'ğŸ’¬' : 'âŒ';
                
                if (isDanmakuEnabled) {
                    startDanmakuTimer();
                } else {
                    clearTimeout(danmakuTimer);
                    // æ¸…é™¤æ‰€æœ‰ç°æœ‰å¼¹å¹•
                    while (danmakuContainer.firstChild) {
                        danmakuContainer.removeChild(danmakuContainer.firstChild);
                    }
                    activeDanmakus = 0;
                }
            });
            
            // å¼€å§‹å¼¹å¹•è®¡æ—¶å™¨
            startDanmakuTimer();
            
            function startDanmakuTimer() {
                if (isDanmakuEnabled) {
                    danmakuTimer = setTimeout(createDanmaku, CONFIG.danmakuInterval);
                }
            }
            
            // åˆ›å»ºå¼¹å¹•
            function createDanmaku() {
                if (!isDanmakuEnabled || activeDanmakus >= CONFIG.maxActiveDanmakus) {
                    startDanmakuTimer();
                    return;
                }
                
                // æŒ‰é¡ºåºè·å–å¼¹å¹•æ–‡æœ¬ï¼ˆä¿®æ”¹ä¸ºé¡ºåºæ¨¡å¼ï¼‰
                let text = CONFIG.danmakuTexts[currentDanmakuIndex];
                currentDanmakuIndex = (currentDanmakuIndex + 1) % CONFIG.danmakuTexts.length; // å¾ªç¯ç´¢å¼•
                
                // åˆ›å»ºå¼¹å¹•å…ƒç´ 
                const danmaku = document.createElement('div');
                danmaku.className = 'danmaku';
                danmaku.textContent = text;
                
                // éšæœºé€‰æ‹©é€Ÿåº¦å’Œä½ç½®
                const speeds = ['fast', 'medium', 'slow'];
                const randomSpeed = speeds[Math.floor(Math.random() * speeds.length)];
                danmaku.classList.add(`danmaku-${randomSpeed}`);
                
                // éšæœºå‚ç›´ä½ç½®ï¼ˆé¿å¼€é¡¶éƒ¨å¯¼èˆªå’Œåº•éƒ¨æ’­æ”¾å™¨ï¼‰
                const topPosition = Math.floor(Math.random() * 70) + 15; // 15% åˆ° 85% ä¹‹é—´
                danmaku.style.top = `${topPosition}%`;
                
                // æ·»åŠ åˆ°å®¹å™¨
                danmakuContainer.appendChild(danmaku);
                activeDanmakus++;
                
                // è®¾ç½®å¼¹å¹•æ¶ˆå¤±
                const duration = randomSpeed === 'fast' ? 8000 : randomSpeed === 'medium' ? 12000 : 16000;
                setTimeout(function() {
                    if (danmaku.parentNode === danmakuContainer) {
                        danmakuContainer.removeChild(danmaku);
                        activeDanmakus--;
                    }
                }, duration);
                
                // ç»§ç»­åˆ›å»ºä¸‹ä¸€æ¡å¼¹å¹•
                startDanmakuTimer();
            }
        }
    </script>
</body>
</html>
